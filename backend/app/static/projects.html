<!DOCTYPE html>
<html lang="lt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex, nofollow" />
    <meta name="description" content="VejaPRO – projektų valdymas." />
    <title>VejaPRO – Projektai</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="/static/admin-shared.css?v=3.3" />
    <style>
      /* Page-specific only (keep minimal). */
      .section{margin-bottom:14px;}
      .token-grid{display:grid;grid-template-columns:1fr auto auto;gap:8px;align-items:end;margin-bottom:8px;}
      .small-muted{font-size:12px;color:var(--ink-muted);}
      .mt-8{margin-top:8px;} .mt-10{margin-top:10px;}
      .subheader{padding:0 0 12px 0;border:0;} .section-title{margin:0;font-size:14px;}
      .inline-check{display:flex;align-items:center;gap:8px;}
      .modal-footer.wrap{flex-wrap:wrap;}
      #detailsBackdrop .modal{max-width:840px;}
      #clientTokenBackdrop .modal,#manualPaymentBackdrop .modal,#paymentLinkBackdrop .modal{max-width:720px;}
      .data-table.projects th.col-id{width:14%;} .data-table.projects th.col-status{width:10%;}
      .data-table.projects th.col-scheduled{width:16%;} .data-table.projects th.col-contractor{width:16%;}
      .data-table.projects th.col-expert{width:16%;} .data-table.projects th.col-created{width:14%;}
      .data-table.projects th.col-updated{width:14%;} .data-table.projects th.col-actions{width:20%;}
      pre.code{margin:0;padding:12px;background:#0b1020;color:#e5e7eb;border-radius:var(--radius);overflow:auto;max-height:60vh;font-size:12px;line-height:1.4;font-family:var(--font-mono);}
      .mono{font-family:var(--font-mono);font-size:12px;} .row-actions{display:flex;flex-wrap:wrap;gap:6px;}
    </style>
  </head>
  <body>
    <button class="hamburger" aria-label="Meniu">&#9776;</button>
    <div class="sidebar-overlay"></div>

    <div class="admin-layout">
      <aside class="sidebar">
        <div class="sidebar-header">
          <a href="/"><img src="/static/logo.png" alt="VejaPRO" class="logo" /></a>
          <span class="brand">VejaPRO</span>
        </div>
        <nav class="sidebar-nav" id="sidebarNav"></nav>
        <div class="sidebar-footer">V3.1 Admin - Modern Design</div>
      </aside>

      <main class="main-content">
        <div class="page-header">
          <h1>Projektai</h1>
          <div class="actions">
            <button class="btn btn-secondary" id="btnRefresh">Atnaujinti</button>
          </div>
        </div>

        <div class="content-area">
          <div class="token-card section">
            <div class="token-card-header">
              <span>&#128274; Bearer zetonas</span>
              <span id="tokenBadge" class="pill pill-gray">Nenustatytas</span>
            </div>
            <div class="token-card-body">
              <div class="token-grid">
                <input id="tokenInput" type="password" class="form-input" placeholder="Iklijuokite JWT zetona" />
                <button class="btn" id="btnGenerate">Generuoti</button>
                <button class="btn btn-secondary" id="btnSaveToken">Issaugoti</button>
              </div>
              <div id="tokenStatus" class="small-muted"></div>
            </div>
          </div>

          <div class="card section">
            <div class="page-header subheader">
              <h2 class="section-title">Sukurti projekta</h2>
            </div>
            <div class="form-grid">
              <div class="form-group">
                <label for="createName">Kliento vardas</label>
                <input id="createName" class="form-input" placeholder="Vardas" />
              </div>
              <div class="form-group">
                <label for="createClientId">Kliento ID (UUID rekomenduojama)</label>
                <input id="createClientId" class="form-input" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" />
              </div>
              <div class="form-group">
                <label for="createPhone">Telefonas (neprivaloma)</label>
                <input id="createPhone" class="form-input" placeholder="+370..." />
              </div>
              <div class="form-group">
                <label class="sr-only" for="btnCreate">Sukurti</label>
                <button class="btn btn-primary" id="btnCreate">Sukurti</button>
              </div>
            </div>
            <div id="createStatus" class="small-muted mt-10"></div>
          </div>

          <div class="card section">
            <div class="filters-bar">
              <div class="filter-group">
                <label for="filterStatus">Status</label>
                <select id="filterStatus" class="form-select">
                  <option value="">Visi</option>
                  <option value="DRAFT">DRAFT</option>
                  <option value="PAID">PAID</option>
                  <option value="SCHEDULED">SCHEDULED</option>
                  <option value="PENDING_EXPERT">PENDING_EXPERT</option>
                  <option value="CERTIFIED">CERTIFIED</option>
                  <option value="ACTIVE">ACTIVE</option>
                </select>
              </div>
              <div class="filter-group">
                <label for="filterContractor">Rangovas</label>
                <input id="filterContractor" class="form-input" placeholder="UUID" />
              </div>
              <div class="filter-group">
                <label for="filterExpert">Ekspertas</label>
                <input id="filterExpert" class="form-input" placeholder="UUID" />
              </div>
              <div class="filter-group">
                <label for="filterLimit">Limitas</label>
                <select id="filterLimit" class="form-select">
                  <option value="50">50</option>
                  <option value="100">100</option>
                  <option value="200">200</option>
                </select>
              </div>
              <button class="btn btn-primary" id="btnApply">Taikyti</button>
              <button class="btn btn-ghost" id="btnClear">Valyti</button>
            </div>

            <div class="table-container">
              <table class="data-table projects">
                <thead>
                  <tr>
                    <th class="col-id">ID</th>
                    <th class="col-status">Status</th>
                    <th class="col-scheduled">Suplanuota</th>
                    <th class="col-contractor">Rangovas</th>
                    <th class="col-expert">Ekspertas</th>
                    <th class="col-created">Sukurta</th>
                    <th class="col-updated">Atnaujinta</th>
                    <th class="col-actions">Veiksmai</th>
                  </tr>
                </thead>
                <tbody id="rows"></tbody>
              </table>
            </div>

            <div class="pagination">
              <button class="btn btn-secondary" id="btnLoadMore">Ikelti daugiau</button>
              <span id="count" class="small-muted"></span>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Assign modal -->
    <div class="modal-backdrop" id="assignBackdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="assignTitle">
        <div class="modal-header">
          <h2 id="assignTitle">Priskirti</h2>
          <button class="modal-close" id="btnAssignClose" aria-label="Uzdaryti">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="assigneeInput">Asmens UUID</label>
            <input id="assigneeInput" class="form-input" placeholder="UUID" />
            <div class="hint">Tik UUID formatas. Roles tikrinamos serverio puseje.</div>
          </div>
          <div class="form-group">
            <label class="inline-check">
              <input type="checkbox" id="confirmAssignCheck" />
              Patvirtinu veiksma
            </label>
          </div>
          <div id="assignStatus" class="small-muted"></div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-ghost" id="btnAssignCancel">Atsaukti</button>
          <button class="btn btn-primary" id="btnAssignConfirm">Patvirtinti</button>
        </div>
      </div>
    </div>

    <!-- Details modal -->
    <div class="modal-backdrop" id="detailsBackdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="detailsTitle">
        <div class="modal-header">
          <h2 id="detailsTitle">Projekto detales</h2>
          <button class="modal-close" id="btnDetailsClose" aria-label="Uzdaryti">&times;</button>
        </div>
        <div class="modal-body">
          <pre class="code" id="detailsJson">{}</pre>
          <div class="small-muted mt-8">Pastaba: PII (email/phone) yra maskuojami UI puseje.</div>
        </div>
      </div>
    </div>

    <!-- Client token modal -->
    <div class="modal-backdrop" id="clientTokenBackdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="clientTokenTitle">
        <div class="modal-header">
          <h2 id="clientTokenTitle">Kliento zetonas</h2>
          <button class="modal-close" id="btnClientTokenClose" aria-label="Uzdaryti">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="clientTokenValue">Zetonas</label>
            <input id="clientTokenValue" class="form-input mono" readonly />
            <div class="hint" id="clientTokenMeta"></div>
          </div>
          <div class="row-actions">
            <button class="btn btn-secondary btn-sm" id="btnCopyClientToken">Kopijuoti zetona</button>
            <button class="btn btn-ghost btn-sm" id="btnCopyClientLink">Kopijuoti portalo nuoroda</button>
          </div>
          <div class="mt-10">
            <a id="clientPortalLink" href="#" target="_blank" rel="noreferrer">Atidaryti kliento portala</a>
          </div>
          <div class="small-muted mt-8" id="clientTokenStatus"></div>
        </div>
      </div>
    </div>

    <!-- Manual payment modal -->
    <div class="modal-backdrop" id="manualPaymentBackdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="manualPaymentTitle">
        <div class="modal-header">
          <h2 id="manualPaymentTitle">Rankinis mokejimas</h2>
          <button class="modal-close" id="btnManualPaymentClose" aria-label="Uzdaryti">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-grid">
            <div class="form-group">
              <label for="manualPaymentType">Tipas</label>
              <select id="manualPaymentType" class="form-select">
                <option value="DEPOSIT">DEPOSIT</option>
                <option value="FINAL">FINAL</option>
              </select>
            </div>
            <div class="form-group">
              <label for="manualPaymentCurrency">Valiuta</label>
              <input id="manualPaymentCurrency" class="form-input" value="EUR" />
            </div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="manualPaymentAmount">Suma</label>
              <input id="manualPaymentAmount" class="form-input" type="number" min="0" step="0.01" placeholder="0.00" />
            </div>
            <div class="form-group">
              <label for="manualPaymentMethod">Budas</label>
              <select id="manualPaymentMethod" class="form-select">
                <option value="BANK_TRANSFER">BANK_TRANSFER</option>
                <option value="CASH">CASH</option>
                <option value="OTHER">OTHER</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="manualProviderEventId">Nuoroda / ID (idempotencija)</label>
            <input id="manualProviderEventId" class="form-input" placeholder="Pvz. PAVEDIMAS-2026-02-08-001 arba UUID" />
          </div>
          <div class="form-group">
            <label for="manualReceiptNo">Kvito nr. (neprivaloma)</label>
            <input id="manualReceiptNo" class="form-input" placeholder="Pvz. KV-001" />
          </div>
          <div class="form-group">
            <label for="manualPaymentNotes">Pastabos (neprivaloma)</label>
            <input id="manualPaymentNotes" class="form-input" placeholder="Trumpas komentaras" />
          </div>
          <div id="manualPaymentStatus" class="small-muted"></div>
        </div>
        <div class="modal-footer wrap">
          <button class="btn btn-ghost" id="btnManualPaymentCancel">Atsaukti</button>
          <button class="btn btn-primary" id="btnManualPaymentConfirm">Irasyti mokejima</button>
          <button class="btn btn-secondary" id="btnWaiveDeposit" title="Be pradinio inaso (pasitikime klientu)">Atideti inasa</button>
        </div>
      </div>
    </div>

    <!-- Stripe payment link modal -->
    <div class="modal-backdrop" id="paymentLinkBackdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="paymentLinkTitle">
        <div class="modal-header">
          <h2 id="paymentLinkTitle">Stripe mokejimo nuoroda</h2>
          <button class="modal-close" id="btnPaymentLinkClose" aria-label="Uzdaryti">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-grid">
            <div class="form-group">
              <label for="paymentType">Tipas</label>
              <select id="paymentType" class="form-select">
                <option value="DEPOSIT">DEPOSIT</option>
                <option value="FINAL">FINAL</option>
              </select>
            </div>
            <div class="form-group">
              <label for="paymentCurrency">Valiuta</label>
              <input id="paymentCurrency" class="form-input" value="EUR" />
            </div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="paymentAmount">Suma</label>
              <input id="paymentAmount" class="form-input" type="number" min="0" step="0.01" placeholder="0.00" />
            </div>
            <div class="form-group">
              <label for="paymentDescription">Aprasymas (neprivaloma)</label>
              <input id="paymentDescription" class="form-input" placeholder="VejaPRO mokejimas" />
            </div>
          </div>
          <div class="form-group">
            <label for="paymentSuccessUrl">Sekmes URL (neprivaloma)</label>
            <input id="paymentSuccessUrl" class="form-input" placeholder="https://..." />
          </div>
          <div class="form-group">
            <label for="paymentCancelUrl">Atsaukimo URL (neprivaloma)</label>
            <input id="paymentCancelUrl" class="form-input" placeholder="https://..." />
          </div>
          <div class="form-group">
            <label for="paymentLinkValue">Mokejimo URL</label>
            <input id="paymentLinkValue" class="form-input mono" readonly />
          </div>
          <div class="row-actions">
            <button class="btn btn-primary btn-sm" id="btnCreatePaymentLink">Sukurti nuoroda</button>
            <button class="btn btn-secondary btn-sm" id="btnCopyPaymentLink">Kopijuoti</button>
          </div>
          <div class="mt-10">
            <a id="openPaymentLink" href="#" target="_blank" rel="noreferrer">Atidaryti mokejimo nuoroda</a>
          </div>
          <div class="small-muted mt-8" id="paymentStatus"></div>
        </div>
      </div>
    </div>

    <script src="/static/admin-shared.js?v=3.3"></script>
    <script src="/static/admin-projects.js?v=3.1"></script>
  </body>
</html>
